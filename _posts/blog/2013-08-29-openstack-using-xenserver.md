---layout: posttitle: 在OpenStack使用XenServer资源池浅析description: 在OpenStack使用XenServer资源池浅析category: blog---OpenStack中的Xen driver类：nova/virt/xenapi/driver.py中的XenAPIDriver类，该类继承的ComputeDriver是所有driver的基类，是所有虚拟机相关功能集合，而XenAPIDriver实现的方法是ComputeDriver类中方法的子集。### 创建资源池并添加主机使用xenserver资源池（支持虚拟机热迁移）前提：  1. 有符合创建资源池的xenserver主机，已部署openstack（nova-compute）  2. 有共享存储### XenAPIDriver的初始化所有xenserver主机加入资源池后，XenAPIDriver的初始化操作如下：- 首先，初始化一个XenAPISession对象。在该对象中保存了调用XenAPI的调用接口、连接master主机的session、xenserver主机的标识- 初始化VolumeOps。包含卷相关的操作。- 初始化VMOps。包含了虚拟机相关的操作。- 一个ResourcePool对象。该对象中包含了xenserver主机的名称，地址，标识以及调用nova-compute的RPC代理。注意：第一步中的session就是后续所有操作的基础。即虚拟机和卷相关的操作都会发送到master节点，在资源池范围内进行处理。